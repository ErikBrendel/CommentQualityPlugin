commented;modifiers;parameterAmount;loc;comment;code
true;public;0;12;/**  * Test policy with null codesource.  * <p>  * This can happen when restricting privileges with doPrivileged,  * even though ProtectionDomain's ctor javadocs might make you think  * that the policy won't be consulted.  */ ;/**  * Test policy with null codesource.  * <p>  * This can happen when restricting privileges with doPrivileged,  * even though ProtectionDomain's ctor javadocs might make you think  * that the policy won't be consulted.  */ @SuppressForbidden(reason = "to create FilePermission object") public void testNullCodeSource() throws Exception {     assumeTrue("test cannot run with security manager", System.getSecurityManager() == null).     // create a policy with AllPermission     Permission all = new AllPermission().     PermissionCollection allCollection = all.newPermissionCollection().     allCollection.add(all).     ESPolicy policy = new ESPolicy(Collections.emptyMap(), allCollection, Collections.emptyMap(), true).     // restrict ourselves to NoPermission     PermissionCollection noPermissions = new Permissions().     assertFalse(policy.implies(new ProtectionDomain(null, noPermissions), new FilePermission("foo", "read"))). }
true;public;0;8;/**  * test with null location  * <p>  * its unclear when/if this happens, see https://bugs.openjdk.java.net/browse/JDK-8129972  */ ;/**  * test with null location  * <p>  * its unclear when/if this happens, see https://bugs.openjdk.java.net/browse/JDK-8129972  */ @SuppressForbidden(reason = "to create FilePermission object") public void testNullLocation() throws Exception {     assumeTrue("test cannot run with security manager", System.getSecurityManager() == null).     PermissionCollection noPermissions = new Permissions().     ESPolicy policy = new ESPolicy(Collections.emptyMap(), noPermissions, Collections.emptyMap(), true).     assertFalse(policy.implies(new ProtectionDomain(new CodeSource(null, (Certificate[]) null), noPermissions), new FilePermission("foo", "read"))). }
false;public;0;9;;public void testListen() {     assumeTrue("test cannot run with security manager", System.getSecurityManager() == null).     final PermissionCollection noPermissions = new Permissions().     final ESPolicy policy = new ESPolicy(Collections.emptyMap(), noPermissions, Collections.emptyMap(), true).     assertFalse(policy.implies(new ProtectionDomain(ESPolicyUnitTests.class.getProtectionDomain().getCodeSource(), noPermissions), new SocketPermission("localhost:" + randomFrom(0, randomIntBetween(49152, 65535)), "listen"))). }
