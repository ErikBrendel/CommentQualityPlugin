commented;modifiers;parameterAmount;loc;comment;code
false;protected;3;12;;@Override protected void doExecute(Task task, SamlPrepareAuthenticationRequest request, ActionListener<SamlPrepareAuthenticationResponse> listener) {     List<SamlRealm> realms = findSamlRealms(this.realms, request.getRealmName(), request.getAssertionConsumerServiceURL()).     if (realms.isEmpty()) {         listener.onFailure(SamlUtils.samlException("Cannot find any matching realm for [{}]", request)).     } else if (realms.size() > 1) {         listener.onFailure(SamlUtils.samlException("Found multiple matching realms [{}] for [{}]", realms, request)).     } else {         prepareAuthentication(realms.get(0), listener).     } }
false;private;2;13;;private void prepareAuthentication(SamlRealm realm, ActionListener<SamlPrepareAuthenticationResponse> listener) {     final AuthnRequest authnRequest = realm.buildAuthenticationRequest().     try {         String redirectUrl = new SamlRedirect(authnRequest, realm.getSigningConfiguration()).getRedirectUrl().         listener.onResponse(new SamlPrepareAuthenticationResponse(realm.name(), authnRequest.getID(), redirectUrl)).     } catch (ElasticsearchException e) {         listener.onFailure(e).     } }
