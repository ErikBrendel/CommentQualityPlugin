commented;modifiers;parameterAmount;loc;comment;code
false;public;4;27;;@Override public void intercept(RequestInfo requestInfo, AuthorizationEngine authorizationEngine, AuthorizationInfo authorizationInfo, ActionListener<Void> listener) {     if (requestInfo.getRequest() instanceof IndicesRequest) {         IndicesRequest indicesRequest = (IndicesRequest) requestInfo.getRequest().         if (supports(indicesRequest) && licenseState.isDocumentAndFieldLevelSecurityAllowed()) {             final IndicesAccessControl indicesAccessControl = threadContext.getTransient(AuthorizationServiceField.INDICES_PERMISSIONS_KEY).             for (String index : indicesRequest.indices()) {                 IndicesAccessControl.IndexAccessControl indexAccessControl = indicesAccessControl.getIndexPermissions(index).                 if (indexAccessControl != null) {                     boolean fieldLevelSecurityEnabled = indexAccessControl.getFieldPermissions().hasFieldLevelSecurity().                     boolean documentLevelSecurityEnabled = indexAccessControl.getDocumentPermissions().hasDocumentLevelPermissions().                     if (fieldLevelSecurityEnabled || documentLevelSecurityEnabled) {                         logger.trace("intercepted request for index [{}] with field level access controls [{}] " + "document level access controls [{}]. disabling conflicting features", index, fieldLevelSecurityEnabled, documentLevelSecurityEnabled).                         disableFeatures(indicesRequest, fieldLevelSecurityEnabled, documentLevelSecurityEnabled, listener).                         return.                     }                 }                 logger.trace("intercepted request for index [{}] without field or document level access controls", index).             }         }     }     listener.onResponse(null). }
false;abstract;4;2;;abstract void disableFeatures(IndicesRequest request, boolean fieldLevelSecurityEnabled, boolean documentLevelSecurityEnabled, ActionListener<Void> listener).
false;abstract;1;1;;abstract boolean supports(IndicesRequest request).
