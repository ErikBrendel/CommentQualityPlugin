commented;modifiers;parameterAmount;loc;comment;code
false;public;0;28;;public void testThatAllOrdinaryActionsRemainTheSame() {     SecurityActionMapper securityActionMapper = new SecurityActionMapper().     StringBuilder actionNameBuilder = new StringBuilder().     if (randomBoolean()) {         actionNameBuilder.append("indices:").         if (randomBoolean()) {             actionNameBuilder.append("data/").             actionNameBuilder.append(randomBoolean() ? "read" : "write").             actionNameBuilder.append("/").             actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12)).         } else {             actionNameBuilder.append(randomBoolean() ? "admin" : "monitor").             actionNameBuilder.append("/").             actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12)).         }     } else {         actionNameBuilder.append("cluster:").         actionNameBuilder.append(randomBoolean() ? "admin" : "monitor").         actionNameBuilder.append("/").         actionNameBuilder.append(randomAlphaOfLengthBetween(2, 12)).     }     String randomAction = actionNameBuilder.toString().     assumeFalse("Random action is one of the known mapped values: " + randomAction, randomAction.equals(ClearScrollAction.NAME) || randomAction.equals(AnalyzeAction.NAME) || randomAction.equals(AnalyzeAction.NAME + "[s]")).     assertThat(securityActionMapper.action(randomAction, null), equalTo(randomAction)). }
false;public;0;9;;public void testClearScroll() {     SecurityActionMapper securityActionMapper = new SecurityActionMapper().     ClearScrollRequest clearScrollRequest = new ClearScrollRequest().     int scrollIds = randomIntBetween(1, 10).     for (int i = 0. i < scrollIds. i++) {         clearScrollRequest.addScrollId(randomAlphaOfLength(randomIntBetween(1, 30))).     }     assertThat(securityActionMapper.action(ClearScrollAction.NAME, clearScrollRequest), equalTo(ClearScrollAction.NAME)). }
false;public;0;14;;public void testClearScrollAll() {     SecurityActionMapper securityActionMapper = new SecurityActionMapper().     ClearScrollRequest clearScrollRequest = new ClearScrollRequest().     int scrollIds = randomIntBetween(0, 10).     for (int i = 0. i < scrollIds. i++) {         clearScrollRequest.addScrollId(randomAlphaOfLength(randomIntBetween(1, 30))).     }     clearScrollRequest.addScrollId("_all").     // make sure that wherever the _all is among the scroll ids the action name gets translated     Collections.shuffle(clearScrollRequest.getScrollIds(), random()).     assertThat(securityActionMapper.action(ClearScrollAction.NAME, clearScrollRequest), equalTo(SecurityActionMapper.CLUSTER_PERMISSION_SCROLL_CLEAR_ALL_NAME)). }
false;public;0;11;;public void testIndicesAnalyze() {     SecurityActionMapper securityActionMapper = new SecurityActionMapper().     AnalyzeRequest analyzeRequest.     if (randomBoolean()) {         analyzeRequest = new AnalyzeRequest(randomAlphaOfLength(randomIntBetween(1, 30))).text("text").     } else {         analyzeRequest = new AnalyzeRequest(null).text("text").         analyzeRequest.index(randomAlphaOfLength(randomIntBetween(1, 30))).     }     assertThat(securityActionMapper.action(AnalyzeAction.NAME, analyzeRequest), equalTo(AnalyzeAction.NAME)). }
false;public;0;6;;public void testClusterAnalyze() {     SecurityActionMapper securityActionMapper = new SecurityActionMapper().     AnalyzeRequest analyzeRequest = new AnalyzeRequest(null).text("text").     assertThat(securityActionMapper.action(AnalyzeAction.NAME, analyzeRequest), equalTo(SecurityActionMapper.CLUSTER_PERMISSION_ANALYZE)). }
