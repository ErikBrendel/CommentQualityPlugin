commented;modifiers;parameterAmount;loc;comment;code
true;public;0;11;// test that we reject a role where field permissions are stored in 2.x format (fields:...) ;// test that we reject a role where field permissions are stored in 2.x format (fields:...) public void testBWCFieldPermissions() throws Exception {     Path path = getDataPath("roles2xformat.json").     byte[] bytes = Files.readAllBytes(path).     String roleString = new String(bytes, Charset.defaultCharset()).     try (Client client = new NoOpClient("testBWCFieldPermissions")) {         ElasticsearchParseException e = expectThrows(ElasticsearchParseException.class, () -> new PutRoleRequestBuilder(client).source("role1", new BytesArray(roleString), XContentType.JSON)).         assertThat(e.getDetailedMessage(), containsString("\"fields\": [...]] format has changed for field permissions in role " + "[role1], use [\"field_security\": {\"grant\":[...],\"except\":[...]}] instead")).     } }
