commented;modifiers;parameterAmount;loc;comment;code
false;public;0;12;;public void testBasicLicense() throws Exception {     final XPackLicenseState licenseState = mock(XPackLicenseState.class).     final RestHasPrivilegesAction action = new RestHasPrivilegesAction(Settings.EMPTY, mock(RestController.class), mock(SecurityContext.class), licenseState).     when(licenseState.isSecurityAvailable()).thenReturn(false).     final FakeRestRequest request = new FakeRestRequest().     final FakeRestChannel channel = new FakeRestChannel(request, true, 1).     action.handleRequest(request, channel, mock(NodeClient.class)).     assertThat(channel.capturedResponse(), notNullValue()).     assertThat(channel.capturedResponse().status(), equalTo(RestStatus.FORBIDDEN)).     assertThat(channel.capturedResponse().content().utf8ToString(), containsString("current license is non-compliant for [security]")). }
