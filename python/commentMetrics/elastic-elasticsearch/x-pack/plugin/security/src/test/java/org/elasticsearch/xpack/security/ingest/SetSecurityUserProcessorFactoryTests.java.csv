commented;modifiers;parameterAmount;loc;comment;code
false;public;0;8;;public void testProcessor() throws Exception {     SetSecurityUserProcessor.Factory factory = new SetSecurityUserProcessor.Factory(null).     Map<String, Object> config = new HashMap<>().     config.put("field", "_field").     SetSecurityUserProcessor processor = factory.create(null, "_tag", config).     assertThat(processor.getField(), equalTo("_field")).     assertThat(processor.getProperties(), equalTo(EnumSet.allOf(Property.class))). }
false;public;0;8;;public void testProcessor_noField() throws Exception {     SetSecurityUserProcessor.Factory factory = new SetSecurityUserProcessor.Factory(null).     Map<String, Object> config = new HashMap<>().     ElasticsearchParseException e = expectThrows(ElasticsearchParseException.class, () -> factory.create(null, "_tag", config)).     assertThat(e.getMetadata("es.property_name").get(0), equalTo("field")).     assertThat(e.getMetadata("es.processor_type").get(0), equalTo(SetSecurityUserProcessor.TYPE)).     assertThat(e.getMetadata("es.processor_tag").get(0), equalTo("_tag")). }
false;public;0;9;;public void testProcessor_validProperties() throws Exception {     SetSecurityUserProcessor.Factory factory = new SetSecurityUserProcessor.Factory(null).     Map<String, Object> config = new HashMap<>().     config.put("field", "_field").     config.put("properties", Arrays.asList(Property.USERNAME.name(), Property.ROLES.name())).     SetSecurityUserProcessor processor = factory.create(null, "_tag", config).     assertThat(processor.getField(), equalTo("_field")).     assertThat(processor.getProperties(), equalTo(EnumSet.of(Property.USERNAME, Property.ROLES))). }
false;public;0;10;;public void testProcessor_invalidProperties() throws Exception {     SetSecurityUserProcessor.Factory factory = new SetSecurityUserProcessor.Factory(null).     Map<String, Object> config = new HashMap<>().     config.put("field", "_field").     config.put("properties", Arrays.asList("invalid")).     ElasticsearchParseException e = expectThrows(ElasticsearchParseException.class, () -> factory.create(null, "_tag", config)).     assertThat(e.getMetadata("es.property_name").get(0), equalTo("properties")).     assertThat(e.getMetadata("es.processor_type").get(0), equalTo(SetSecurityUserProcessor.TYPE)).     assertThat(e.getMetadata("es.processor_tag").get(0), equalTo("_tag")). }
