commented;modifiers;parameterAmount;loc;comment;code
false;public;0;8;;@Before public void init() throws Exception {     clusterService = mock(ClusterService.class).     clock = ClockMock.frozen().     discoveryNodes = mock(DiscoveryNodes.class).     resourceWatcherService = mock(ResourceWatcherService.class).     environment = mock(Environment.class). }
false;protected;3;3;;protected void setInitialState(License license, XPackLicenseState licenseState, Settings settings) {     setInitialState(license, licenseState, settings, randomBoolean() ? "trial" : "basic"). }
false;protected;4;23;;protected void setInitialState(License license, XPackLicenseState licenseState, Settings settings, String selfGeneratedType) {     Path tempDir = createTempDir().     when(environment.configFile()).thenReturn(tempDir).     licenseType = selfGeneratedType.     settings = Settings.builder().put(settings).put(LicenseService.SELF_GENERATED_LICENSE_TYPE.getKey(), licenseType).build().     licenseService = new LicenseService(settings, clusterService, clock, environment, resourceWatcherService, licenseState).     ClusterState state = mock(ClusterState.class).     final ClusterBlocks noBlock = ClusterBlocks.builder().build().     when(state.blocks()).thenReturn(noBlock).     MetaData metaData = mock(MetaData.class).     when(metaData.custom(LicensesMetaData.TYPE)).thenReturn(new LicensesMetaData(license, null)).     when(state.metaData()).thenReturn(metaData).     final DiscoveryNode mockNode = getLocalNode().     when(discoveryNodes.getMasterNode()).thenReturn(mockNode).     when(discoveryNodes.spliterator()).thenReturn(Arrays.asList(mockNode).spliterator()).     when(discoveryNodes.isLocalNodeElectedMaster()).thenReturn(false).     when(state.nodes()).thenReturn(discoveryNodes).     // it is really ridiculous we have nodes() and getNodes()...     when(state.getNodes()).thenReturn(discoveryNodes).     when(clusterService.state()).thenReturn(state).     when(clusterService.lifecycleState()).thenReturn(Lifecycle.State.STARTED).     when(clusterService.getClusterName()).thenReturn(new ClusterName("a")).     when(clusterService.localNode()).thenReturn(mockNode). }
false;protected;0;4;;protected DiscoveryNode getLocalNode() {     return new DiscoveryNode("b", buildNewFakeTransportAddress(), singletonMap(XPackPlugin.XPACK_INSTALLED_NODE_ATTR, "true"), emptySet(), Version.CURRENT). }
false;public;0;5;;@After public void tearDown() throws Exception {     super.tearDown().     licenseService.stop(). }
