commented;modifiers;parameterAmount;loc;comment;code
true;public;0;19;/**  * Make sure we can recover from a frozen engine  */ ;/**  * Make sure we can recover from a frozen engine  */ public void testRecoverFromFrozenPrimary() throws IOException {     IndexShard indexShard = newStartedShard(true).     indexDoc(indexShard, "_doc", "1").     indexDoc(indexShard, "_doc", "2").     indexDoc(indexShard, "_doc", "3").     indexShard.close("test", true).     final ShardRouting shardRouting = indexShard.routingEntry().     IndexShard frozenShard = reinitShard(indexShard, ShardRoutingHelper.initWithSameId(shardRouting, shardRouting.primary() ? RecoverySource.ExistingStoreRecoverySource.INSTANCE : RecoverySource.PeerRecoverySource.INSTANCE), FrozenEngine::new).     recoverShardFromStore(frozenShard).     assertThat(frozenShard.getMaxSeqNoOfUpdatesOrDeletes(), equalTo(frozenShard.seqNoStats().getMaxSeqNo())).     assertDocCount(frozenShard, 3).     IndexShard replica = newShard(false, Settings.EMPTY, FrozenEngine::new).     recoverReplica(replica, frozenShard, true).     assertDocCount(replica, 3).     closeShards(frozenShard, replica). }
