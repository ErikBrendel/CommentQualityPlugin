commented;modifiers;parameterAmount;loc;comment;code
false;protected;0;4;;@Override protected int numberOfShards() {     return 3. }
false;protected;0;4;;@Override protected int numberOfReplicas() {     return 1. }
false;public;0;45;;public void testSaneAllocation() {     assertAcked(prepareCreate("test", 3)).     if (randomBoolean()) {         assertAcked(client().admin().indices().prepareClose("test")).     }     ensureGreen("test").     ClusterState state = client().admin().cluster().prepareState().execute().actionGet().getState().     assertThat(state.getRoutingNodes().unassigned().size(), equalTo(0)).     for (RoutingNode node : state.getRoutingNodes()) {         if (!node.isEmpty()) {             assertThat(node.size(), equalTo(2)).         }     }     client().admin().indices().prepareUpdateSettings("test").setSettings(Settings.builder().put(SETTING_NUMBER_OF_REPLICAS, 0)).execute().actionGet().     ensureGreen("test").     state = client().admin().cluster().prepareState().execute().actionGet().getState().     assertThat(state.getRoutingNodes().unassigned().size(), equalTo(0)).     for (RoutingNode node : state.getRoutingNodes()) {         if (!node.isEmpty()) {             assertThat(node.size(), equalTo(1)).         }     }     // create another index     assertAcked(prepareCreate("test2", 3)).     if (randomBoolean()) {         assertAcked(client().admin().indices().prepareClose("test2")).     }     ensureGreen("test2").     client().admin().indices().prepareUpdateSettings("test").setSettings(Settings.builder().put(SETTING_NUMBER_OF_REPLICAS, 1)).execute().actionGet().     ensureGreen("test").     state = client().admin().cluster().prepareState().execute().actionGet().getState().     assertThat(state.getRoutingNodes().unassigned().size(), equalTo(0)).     for (RoutingNode node : state.getRoutingNodes()) {         if (!node.isEmpty()) {             assertThat(node.size(), equalTo(4)).         }     } }
