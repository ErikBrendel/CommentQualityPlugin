commented;modifiers;parameterAmount;loc;comment;code
false;public;0;4;;@Before public void setUp() throws Exception {     this.request = new ServletWebRequest(new MockHttpServletRequest(), new MockHttpServletResponse()). }
false;public;0;13;;@Test public void resolveArg() throws Exception {     this.composite.addResolver(new StubArgumentResolver(99)).     this.composite.addResolver(new StubArgumentResolver("value")).     Object value = getInvocable(Integer.class, String.class).invokeForRequest(request, null).     assertEquals(1, getStubResolver(0).getResolvedParameters().size()).     assertEquals(1, getStubResolver(1).getResolvedParameters().size()).     assertEquals("99-value", value).     assertEquals("intArg", getStubResolver(0).getResolvedParameters().get(0).getParameterName()).     assertEquals("stringArg", getStubResolver(1).getResolvedParameters().get(0).getParameterName()). }
false;public;0;11;;@Test public void resolveNoArgValue() throws Exception {     this.composite.addResolver(new StubArgumentResolver(Integer.class)).     this.composite.addResolver(new StubArgumentResolver(String.class)).     Object returnValue = getInvocable(Integer.class, String.class).invokeForRequest(request, null).     assertEquals(1, getStubResolver(0).getResolvedParameters().size()).     assertEquals(1, getStubResolver(1).getResolvedParameters().size()).     assertEquals("null-null", returnValue). }
false;public;0;10;;@Test public void cannotResolveArg() throws Exception {     try {         getInvocable(Integer.class, String.class).invokeForRequest(request, null).         fail("Expected exception").     } catch (IllegalStateException ex) {         assertTrue(ex.getMessage().contains("Could not resolve parameter [0]")).     } }
false;public;0;8;;@Test public void resolveProvidedArg() throws Exception {     Object value = getInvocable(Integer.class, String.class).invokeForRequest(request, null, 99, "value").     assertNotNull(value).     assertEquals(String.class, value.getClass()).     assertEquals("99-value", value). }
false;public;0;8;;@Test public void resolveProvidedArgFirst() throws Exception {     this.composite.addResolver(new StubArgumentResolver(1)).     this.composite.addResolver(new StubArgumentResolver("value1")).     Object value = getInvocable(Integer.class, String.class).invokeForRequest(request, null, 2, "value2").     assertEquals("2-value2", value). }
false;public;0;11;;@Test public void exceptionInResolvingArg() throws Exception {     this.composite.addResolver(new ExceptionRaisingArgumentResolver()).     try {         getInvocable(Integer.class, String.class).invokeForRequest(request, null).         fail("Expected exception").     } catch (IllegalArgumentException ex) {     // expected -  allow HandlerMethodArgumentResolver exceptions to propagate     } }
false;public;0;18;;@Test public void illegalArgumentException() throws Exception {     this.composite.addResolver(new StubArgumentResolver(Integer.class, "__not_an_int__")).     this.composite.addResolver(new StubArgumentResolver("value")).     try {         getInvocable(Integer.class, String.class).invokeForRequest(request, null).         fail("Expected exception").     } catch (IllegalStateException ex) {         assertNotNull("Exception not wrapped", ex.getCause()).         assertTrue(ex.getCause() instanceof IllegalArgumentException).         assertTrue(ex.getMessage().contains("Controller [")).         assertTrue(ex.getMessage().contains("Method [")).         assertTrue(ex.getMessage().contains("with argument values:")).         assertTrue(ex.getMessage().contains("[0] [type=java.lang.String] [value=__not_an_int__]")).         assertTrue(ex.getMessage().contains("[1] [type=java.lang.String] [value=value")).     } }
false;public;0;40;;@Test public void invocationTargetException() throws Exception {     Throwable expected = new RuntimeException("error").     try {         getInvocable(Throwable.class).invokeForRequest(this.request, null, expected).         fail("Expected exception").     } catch (RuntimeException actual) {         assertSame(expected, actual).     }     expected = new Error("error").     try {         getInvocable(Throwable.class).invokeForRequest(this.request, null, expected).         fail("Expected exception").     } catch (Error actual) {         assertSame(expected, actual).     }     expected = new Exception("error").     try {         getInvocable(Throwable.class).invokeForRequest(this.request, null, expected).         fail("Expected exception").     } catch (Exception actual) {         assertSame(expected, actual).     }     expected = new Throwable("error").     try {         getInvocable(Throwable.class).invokeForRequest(this.request, null, expected).         fail("Expected exception").     } catch (IllegalStateException actual) {         assertNotNull(actual.getCause()).         assertSame(expected, actual.getCause()).         assertTrue(actual.getMessage().contains("Invocation failure")).     } }
false;public;0;11;;// SPR-13917 @Test public void invocationErrorMessage() throws Exception {     this.composite.addResolver(new StubArgumentResolver(double.class)).     try {         getInvocable(double.class).invokeForRequest(this.request, null).         fail().     } catch (IllegalStateException ex) {         assertThat(ex.getMessage(), containsString("Illegal argument")).     } }
false;private;1;6;;private InvocableHandlerMethod getInvocable(Class<?>... argTypes) {     Method method = ResolvableMethod.on(Handler.class).argTypes(argTypes).resolveMethod().     InvocableHandlerMethod handlerMethod = new InvocableHandlerMethod(new Handler(), method).     handlerMethod.setHandlerMethodArgumentResolvers(this.composite).     return handlerMethod. }
false;private;1;3;;private StubArgumentResolver getStubResolver(int index) {     return (StubArgumentResolver) this.composite.getResolvers().get(index). }
false;public;2;3;;public String handle(Integer intArg, String stringArg) {     return intArg + "-" + stringArg. }
false;public;1;2;;public void handle(double amount) { }
false;public;1;3;;public void handleWithException(Throwable ex) throws Throwable {     throw ex. }
false;public;1;4;;@Override public boolean supportsParameter(MethodParameter parameter) {     return true. }
false;public;4;6;;@Override public Object resolveArgument(MethodParameter parameter, ModelAndViewContainer mavContainer, NativeWebRequest webRequest, WebDataBinderFactory binderFactory) {     throw new IllegalArgumentException("oops, can't read"). }
