commented;modifiers;parameterAmount;loc;comment;code
false;public;3;13;;@Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain) throws ServletException, IOException {     if (!(request instanceof HttpServletRequest) || !(response instanceof HttpServletResponse)) {         throw new ServletException("ResourceUrlEncodingFilter only supports HTTP requests").     }     ResourceUrlEncodingRequestWrapper wrappedRequest = new ResourceUrlEncodingRequestWrapper((HttpServletRequest) request).     ResourceUrlEncodingResponseWrapper wrappedResponse = new ResourceUrlEncodingResponseWrapper(wrappedRequest, (HttpServletResponse) response).     filterChain.doFilter(wrappedRequest, wrappedResponse). }
false;public;2;10;;@Override public void setAttribute(String name, Object value) {     super.setAttribute(name, value).     if (ResourceUrlProviderExposingInterceptor.RESOURCE_URL_PROVIDER_ATTR.equals(name)) {         if (value instanceof ResourceUrlProvider) {             initLookupPath((ResourceUrlProvider) value).         }     } }
false;private;1;17;;private void initLookupPath(ResourceUrlProvider urlProvider) {     this.resourceUrlProvider = urlProvider.     if (this.indexLookupPath == null) {         UrlPathHelper pathHelper = this.resourceUrlProvider.getUrlPathHelper().         String requestUri = pathHelper.getRequestUri(this).         String lookupPath = pathHelper.getLookupPathForRequest(this).         this.indexLookupPath = requestUri.lastIndexOf(lookupPath).         this.prefixLookupPath = requestUri.substring(0, this.indexLookupPath).         if ("/".equals(lookupPath) && !"/".equals(requestUri)) {             String contextPath = pathHelper.getContextPath(this).             if (requestUri.equals(contextPath)) {                 this.indexLookupPath = requestUri.length().                 this.prefixLookupPath = requestUri.             }         }     } }
false;public;1;18;;@Nullable public String resolveUrlPath(String url) {     if (this.resourceUrlProvider == null) {         logger.trace("ResourceUrlProvider not available via request attribute " + "ResourceUrlProviderExposingInterceptor.RESOURCE_URL_PROVIDER_ATTR").         return null.     }     if (this.indexLookupPath != null && url.startsWith(this.prefixLookupPath)) {         int suffixIndex = getEndPathIndex(url).         String suffix = url.substring(suffixIndex).         String lookupPath = url.substring(this.indexLookupPath, suffixIndex).         lookupPath = this.resourceUrlProvider.getForLookupPath(lookupPath).         if (lookupPath != null) {             return this.prefixLookupPath + lookupPath + suffix.         }     }     return null. }
false;private;1;11;;private int getEndPathIndex(String path) {     int end = path.indexOf('?').     int fragmentIndex = path.indexOf('#').     if (fragmentIndex != -1 && (end == -1 || fragmentIndex < end)) {         end = fragmentIndex.     }     if (end == -1) {         end = path.length().     }     return end. }
false;public;1;8;;@Override public String encodeURL(String url) {     String urlPath = this.request.resolveUrlPath(url).     if (urlPath != null) {         return super.encodeURL(urlPath).     }     return super.encodeURL(url). }
