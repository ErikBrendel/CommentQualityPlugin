commented;modifiers;parameterAmount;loc;comment;code
false;public;1;6;;@Override public Object lookup(String name) throws NamingException {     // parameterize     assertTrue(name.equals("java:comp/env/" + jndiName)).     return home. }
false;public;0;34;;@Test public void testInvokesMethod() throws Exception {     final int value = 11.     final String jndiName = "foo".     MyEjb myEjb = mock(MyEjb.class).     given(myEjb.getValue()).willReturn(value).     final MyHome home = mock(MyHome.class).     given(home.create()).willReturn(myEjb).     JndiTemplate jt = new JndiTemplate() {          @Override         public Object lookup(String name) throws NamingException {             // parameterize             assertTrue(name.equals("java:comp/env/" + jndiName)).             return home.         }     }.     LocalStatelessSessionProxyFactoryBean fb = new LocalStatelessSessionProxyFactoryBean().     fb.setJndiName(jndiName).     fb.setResourceRef(true).     fb.setBusinessInterface(MyBusinessMethods.class).     fb.setJndiTemplate(jt).     // Need lifecycle methods     fb.afterPropertiesSet().     MyBusinessMethods mbm = (MyBusinessMethods) fb.getObject().     assertTrue(Proxy.isProxyClass(mbm.getClass())).     assertTrue(mbm.getValue() == value).     verify(myEjb).remove(). }
false;public;1;6;;@Override public Object lookup(String name) throws NamingException {     // parameterize     assertTrue(name.equals("java:comp/env/" + jndiName)).     return myEjb. }
false;public;0;30;;@Test public void testInvokesMethodOnEjb3StyleBean() throws Exception {     final int value = 11.     final String jndiName = "foo".     final MyEjb myEjb = mock(MyEjb.class).     given(myEjb.getValue()).willReturn(value).     JndiTemplate jt = new JndiTemplate() {          @Override         public Object lookup(String name) throws NamingException {             // parameterize             assertTrue(name.equals("java:comp/env/" + jndiName)).             return myEjb.         }     }.     LocalStatelessSessionProxyFactoryBean fb = new LocalStatelessSessionProxyFactoryBean().     fb.setJndiName(jndiName).     fb.setResourceRef(true).     fb.setBusinessInterface(MyBusinessMethods.class).     fb.setJndiTemplate(jt).     // Need lifecycle methods     fb.afterPropertiesSet().     MyBusinessMethods mbm = (MyBusinessMethods) fb.getObject().     assertTrue(Proxy.isProxyClass(mbm.getClass())).     assertTrue(mbm.getValue() == value). }
false;public;1;6;;@Override public Object lookup(String name) throws NamingException {     // parameterize     assertTrue(name.equals(jndiName)).     return home. }
false;public;0;38;;@Test public void testCreateException() throws Exception {     final String jndiName = "foo".     final CreateException cex = new CreateException().     final MyHome home = mock(MyHome.class).     given(home.create()).willThrow(cex).     JndiTemplate jt = new JndiTemplate() {          @Override         public Object lookup(String name) throws NamingException {             // parameterize             assertTrue(name.equals(jndiName)).             return home.         }     }.     LocalStatelessSessionProxyFactoryBean fb = new LocalStatelessSessionProxyFactoryBean().     fb.setJndiName(jndiName).     // no java:comp/env prefix     fb.setResourceRef(false).     fb.setBusinessInterface(MyBusinessMethods.class).     assertEquals(fb.getBusinessInterface(), MyBusinessMethods.class).     fb.setJndiTemplate(jt).     // Need lifecycle methods     fb.afterPropertiesSet().     MyBusinessMethods mbm = (MyBusinessMethods) fb.getObject().     assertTrue(Proxy.isProxyClass(mbm.getClass())).     try {         mbm.getValue().         fail("Should have failed to create EJB").     } catch (EjbAccessException ex) {         assertSame(cex, ex.getCause()).     } }
false;public;1;6;;@Override public Object lookup(String name) throws NamingException {     // parameterize     assertTrue(name.equals("java:comp/env/" + jndiName)).     return home. }
false;public;0;38;;@Test public void testNoBusinessInterfaceSpecified() throws Exception {     // Will do JNDI lookup to get home but won't call create     // Could actually try to figure out interface from create?     final String jndiName = "foo".     final MyHome home = mock(MyHome.class).     JndiTemplate jt = new JndiTemplate() {          @Override         public Object lookup(String name) throws NamingException {             // parameterize             assertTrue(name.equals("java:comp/env/" + jndiName)).             return home.         }     }.     LocalStatelessSessionProxyFactoryBean fb = new LocalStatelessSessionProxyFactoryBean().     fb.setJndiName(jndiName).     fb.setResourceRef(true).     // Don't set business interface     fb.setJndiTemplate(jt).     // Check it's a singleton     assertTrue(fb.isSingleton()).     try {         fb.afterPropertiesSet().         fail("Should have failed to create EJB").     } catch (IllegalArgumentException ex) {         // TODO more appropriate exception?         assertTrue(ex.getMessage().indexOf("businessInterface") != 1).     }     // Expect no methods on home     verifyZeroInteractions(home). }
false;;0;1;;MyBusinessMethods create() throws CreateException.
false;;0;1;;int getValue().
