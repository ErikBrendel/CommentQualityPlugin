commented;modifiers;parameterAmount;loc;comment;code
false;public;0;13;;public void run() {     int start = threadCount * 200.     for (int i = 0. i < 200. i++) {         try {             // do some random sleep to simulate spread in user activity             Thread.sleep(new Random().nextInt(10)).         } catch (InterruptedException e) {         // ignore         }         template.sendBody("direct:start", "<mail><subject>" + (start + i) + "</subject><body>Hello world!</body></mail>").     } }
false;public;0;36;;@Test public void testConcurrency() throws Exception {     int total = 1000.     MockEndpoint mock = getMockEndpoint("mock:result").     mock.expectedMessageCount(total).     // setup a task executor to be able send the messages in parallel     ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor().     executor.setCorePoolSize(5).     executor.afterPropertiesSet().     for (int i = 0. i < 5. i++) {         final int threadCount = i.         executor.execute(new Runnable() {              public void run() {                 int start = threadCount * 200.                 for (int i = 0. i < 200. i++) {                     try {                         // do some random sleep to simulate spread in user activity                         Thread.sleep(new Random().nextInt(10)).                     } catch (InterruptedException e) {                     // ignore                     }                     template.sendBody("direct:start", "<mail><subject>" + (start + i) + "</subject><body>Hello world!</body></mail>").                 }             }         }).     }     mock.assertIsSatisfied().     // must use bodyAs(String.class) to force DOM to be converted to String XML     // for duplication detection     mock.assertNoDuplicates(bodyAs(String.class)).     executor.shutdown(). }
false;public;0;10;;public void configure() throws Exception {     // no retry as we want every failure to submerge     errorHandler(noErrorHandler()).     from("direct:start").to("seda:foo?concurrentConsumers=5").     from("seda:foo?concurrentConsumers=5").to("xquery:org/apache/camel/component/xquery/transform.xquery").to("mock:result"). }
false;protected;0;14;;protected RouteBuilder createRouteBuilder() throws Exception {     return new RouteBuilder() {          public void configure() throws Exception {             // no retry as we want every failure to submerge             errorHandler(noErrorHandler()).             from("direct:start").to("seda:foo?concurrentConsumers=5").             from("seda:foo?concurrentConsumers=5").to("xquery:org/apache/camel/component/xquery/transform.xquery").to("mock:result").         }     }. }
