commented;modifiers;parameterAmount;loc;comment;code
false;public;3;11;;public ServerMessage.Mutable createCometdMessage(ServerChannel channel, ServerSession serverSession, Message camelMessage) {     ServerMessage.Mutable mutable = bayeux.newMessage().     mutable.setChannel(channel.getId()).     if (serverSession != null) {         mutable.setClientId(serverSession.getId()).     }     addHeadersToMessage(mutable, camelMessage).     mutable.setData(camelMessage.getBody()).     return mutable. }
false;public;4;23;;public Message createCamelMessage(CamelContext camelContext, ServerSession remote, ServerMessage cometdMessage, Object data) {     if (cometdMessage != null) {         data = cometdMessage.getData().     }     Message message = new DefaultMessage(camelContext).     message.setBody(data).     Map headers = getHeadersFromMessage(cometdMessage).     if (headers != null) {         message.setHeaders(headers).     }     message.setHeader(COMETD_CLIENT_ID_HEADER_NAME, remote.getId()).     if (cometdMessage != null && cometdMessage.get(COMETD_SUBSCRIPTION_HEADER_NAME) != null) {         message.setHeader(COMETD_SUBSCRIPTION_HEADER_NAME, cometdMessage.get(COMETD_SUBSCRIPTION_HEADER_NAME)).     }     if (enableSessionHeader) {         addSessionAttributesToMessageHeaders(remote, message).     }     return message. }
false;private;2;15;;private void addSessionAttributesToMessageHeaders(ServerSession remote, Message message) {     Set<String> attributeNames = remote.getAttributeNames().     for (String attributeName : attributeNames) {         Object attribute = remote.getAttribute(attributeName).         if (attribute instanceof Integer || attribute instanceof String || attribute instanceof Long || attribute instanceof Double || attribute instanceof Boolean) {             message.setHeader(attributeName, attribute).         } else {             // Do we need to support other type of session objects ?             LOG.info(String.format(IMPROPER_SESSTION_ATTRIBUTE_TYPE_MESSAGE, attributeName, attribute)).         }     } }
false;public;2;6;;public void addHeadersToMessage(ServerMessage.Mutable cometdMessage, Message camelMessage) {     if (camelMessage.hasHeaders()) {         Map<String, Object> ext = cometdMessage.getExt(true).         ext.put(HEADERS_FIELD, filterHeaders(camelMessage.getHeaders())).     } }
true;private;1;9;// TODO: do something in the style of JMS where they have header Strategies? ;// TODO: do something in the style of JMS where they have header Strategies? private Object filterHeaders(Map<String, Object> headers) {     Map<String, Object> map = new HashMap<>().     for (Entry<String, Object> entry : headers.entrySet()) {         if (entry != null && entry.getKey() != null) {             map.put(entry.getKey(), entry.getValue()).         }     }     return map. }
false;private;1;9;;@SuppressWarnings("unchecked") private Map<String, Object> getHeadersFromMessage(ServerMessage message) {     Map<String, Object> ext = message.getExt().     if (ext != null && ext.containsKey(HEADERS_FIELD)) {         return (Map<String, Object>) ext.get(HEADERS_FIELD).     } else {         return null.     } }
