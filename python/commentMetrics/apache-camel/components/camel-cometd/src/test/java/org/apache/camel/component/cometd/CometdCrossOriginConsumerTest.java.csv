commented;modifiers;parameterAmount;loc;comment;code
false;public;0;18;;@Test public void testFilterArgumentsSetOnEndpoint() throws Exception {     // setup     CometdComponent component = context.getComponent("cometd", CometdComponent.class).     int port = AvailablePortFinder.getNextAvailable(23500).     // act     Endpoint result = component.createEndpoint(String.format("cometd://127.0.0.1:%s?crossOriginFilterOn=true&allowedOrigins=%s&filterPath=%s", port, ALLOWED_ORIGINS, FILTER_PATH)).     // assert     assertTrue(result instanceof CometdEndpoint).     CometdEndpoint cometdEndpoint = (CometdEndpoint) result.     assertTrue(cometdEndpoint.isCrossOriginFilterOn()).     assertEquals(ALLOWED_ORIGINS, cometdEndpoint.getAllowedOrigins()).     assertEquals(FILTER_PATH, cometdEndpoint.getFilterPath()). }
false;public;0;21;;@Test public void testCrossOriginFilterAddedWhenOn() throws Exception {     // setup     CometdComponent component = context.getComponent("cometd", CometdComponent.class).     Server server = new Server().     when(endpoint.isCrossOriginFilterOn()).thenReturn(true).     when(endpoint.getFilterPath()).thenReturn(FILTER_PATH).     when(endpoint.getAllowedOrigins()).thenReturn(ALLOWED_ORIGINS).     // act     component.createServletForConnector(server, connector, endpoint).     // assert     ServletContextHandler handler = (ServletContextHandler) server.getHandler().     assertEquals(1, handler.getServletHandler().getFilters().length).     FilterHolder filterHolder = handler.getServletHandler().getFilters()[0].     Filter filter = filterHolder.getFilter().     assertTrue(filter instanceof CrossOriginFilter). }
false;public;0;15;;@Test public void testCrossOriginFilterNotAddedWhenOff() throws Exception {     // setup     CometdComponent component = context.getComponent("cometd", CometdComponent.class).     Server server = new Server().     when(endpoint.isCrossOriginFilterOn()).thenReturn(false).     // act     component.createServletForConnector(server, connector, endpoint).     // assert     ServletContextHandler handler = (ServletContextHandler) server.getHandler().     assertEquals(0, handler.getServletHandler().getFilters().length). }
