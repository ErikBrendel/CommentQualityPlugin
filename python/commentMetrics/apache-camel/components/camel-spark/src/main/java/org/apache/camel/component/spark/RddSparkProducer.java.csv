commented;modifiers;parameterAmount;loc;comment;code
false;public;1;8;;@Override public void process(Exchange exchange) throws Exception {     JavaRDDLike rdd = resolveRdd(exchange).     RddCallback rddCallback = resolveRddCallback(exchange).     Object body = exchange.getIn().getBody().     Object result = body instanceof List ? rddCallback.onRdd(rdd, ((List) body).toArray(new Object[0])) : rddCallback.onRdd(rdd, body).     collectResults(exchange, result). }
false;public;0;4;;@Override public SparkEndpoint getEndpoint() {     return (SparkEndpoint) super.getEndpoint(). }
false;protected;2;13;;// Helpers protected void collectResults(Exchange exchange, Object result) {     if (result instanceof JavaRDD) {         JavaRDD rddResults = (JavaRDD) result.         if (getEndpoint().isCollect()) {             exchange.getIn().setBody(rddResults.collect()).         } else {             exchange.getIn().setBody(result).             exchange.getIn().setHeader(SPARK_RDD_HEADER, result).         }     } else {         exchange.getIn().setBody(result).     } }
false;protected;1;9;;protected JavaRDDLike resolveRdd(Exchange exchange) {     if (exchange.getIn().getHeader(SPARK_RDD_HEADER) != null) {         return (JavaRDD) exchange.getIn().getHeader(SPARK_RDD_HEADER).     } else if (getEndpoint().getRdd() != null) {         return getEndpoint().getRdd().     } else {         throw new IllegalStateException("No RDD defined.").     } }
false;protected;1;9;;protected RddCallback resolveRddCallback(Exchange exchange) {     if (exchange.getIn().getHeader(SPARK_RDD_CALLBACK_HEADER) != null) {         return (RddCallback) exchange.getIn().getHeader(SPARK_RDD_CALLBACK_HEADER).     } else if (getEndpoint().getRddCallback() != null) {         return getEndpoint().getRddCallback().     } else {         throw new IllegalStateException("Cannot resolve RDD callback.").     } }
