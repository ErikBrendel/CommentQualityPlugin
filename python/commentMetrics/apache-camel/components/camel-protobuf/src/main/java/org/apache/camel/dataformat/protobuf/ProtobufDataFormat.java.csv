commented;modifiers;parameterAmount;loc;comment;code
false;public;0;4;;@Override public String getDataFormatName() {     return "protobuf". }
false;public;0;3;;public CamelContext getCamelContext() {     return camelContext. }
false;public;1;3;;public void setCamelContext(CamelContext camelContext) {     this.camelContext = camelContext. }
false;public;1;3;;public void setDefaultInstance(Message instance) {     this.defaultInstance = instance. }
false;public;1;7;;public void setDefaultInstance(Object instance) {     if (instance instanceof Message) {         this.defaultInstance = (Message) instance.     } else {         throw new IllegalArgumentException("The argument for setDefaultInstance should be subClass of com.google.protobuf.Message").     } }
false;public;1;4;;public void setInstanceClass(String className) throws Exception {     ObjectHelper.notNull(className, "ProtobufDataFormat instaceClass").     instanceClassName = className. }
false;public;1;3;;public void setContentTypeHeader(boolean contentTypeHeader) {     this.contentTypeHeader = contentTypeHeader. }
false;public;0;3;;public boolean isContentTypeHeader() {     return contentTypeHeader. }
true;public;1;4;/*      * Defines a content type format in which protobuf message will be      * serialized/deserialized from(to) the Java been. It can be native protobuf      * format or json fields representation. The default value is 'native'.      */ ;/*      * Defines a content type format in which protobuf message will be      * serialized/deserialized from(to) the Java been. It can be native protobuf      * format or json fields representation. The default value is 'native'.      */ public void setContentTypeFormat(String contentTypeFormat) {     StringHelper.notEmpty(contentTypeFormat, "ProtobufDataFormat contentTypeFormat").     this.contentTypeFormat = contentTypeFormat. }
true;public;3;19;/*      * (non-Javadoc)      * @see org.apache.camel.spi.DataFormat#marshal(org.apache.camel.Exchange,      * java.lang.Object, java.io.OutputStream)      */ ;/*      * (non-Javadoc)      * @see org.apache.camel.spi.DataFormat#marshal(org.apache.camel.Exchange,      * java.lang.Object, java.io.OutputStream)      */ public void marshal(final Exchange exchange, final Object graph, final OutputStream outputStream) throws Exception {     String contentTypeHeader = CONTENT_TYPE_HEADER_NATIVE.     if (contentTypeFormat.equals(CONTENT_TYPE_FORMAT_JSON)) {         IOUtils.write(JsonFormat.printer().print((Message) graph), outputStream, "UTF-8").         contentTypeHeader = CONTENT_TYPE_HEADER_JSON.     } else if (contentTypeFormat.equals(CONTENT_TYPE_FORMAT_NATIVE)) {         ((Message) graph).writeTo(outputStream).     } else {         throw new CamelException("Invalid protobuf content type format: " + contentTypeFormat).     }     if (isContentTypeHeader()) {         if (exchange.hasOut()) {             exchange.getOut().setHeader(Exchange.CONTENT_TYPE, contentTypeHeader).         } else {             exchange.getIn().setHeader(Exchange.CONTENT_TYPE, contentTypeHeader).         }     } }
true;public;2;19;/*      * (non-Javadoc)      * @see org.apache.camel.spi.DataFormat#unmarshal(org.apache.camel.Exchange,      * java.io.InputStream)      */ ;/*      * (non-Javadoc)      * @see org.apache.camel.spi.DataFormat#unmarshal(org.apache.camel.Exchange,      * java.io.InputStream)      */ public Object unmarshal(final Exchange exchange, final InputStream inputStream) throws Exception {     ObjectHelper.notNull(defaultInstance, "defaultInstance or instanceClassName must be set", this).     Builder builder = defaultInstance.newBuilderForType().     if (contentTypeFormat.equals(CONTENT_TYPE_FORMAT_JSON)) {         JsonFormat.parser().ignoringUnknownFields().merge(new InputStreamReader(inputStream), builder).     } else if (contentTypeFormat.equals(CONTENT_TYPE_FORMAT_NATIVE)) {         builder = defaultInstance.newBuilderForType().mergeFrom(inputStream).     } else {         throw new CamelException("Invalid protobuf content type format: " + contentTypeFormat).     }     if (!builder.isInitialized()) {         // TODO which exception should be thrown here?         throw new InvalidPayloadException(exchange, defaultInstance.getClass()).     }     return builder.build(). }
false;protected;2;14;;protected Message loadDefaultInstance(final String className, final CamelContext context) throws CamelException, ClassNotFoundException {     Class<?> instanceClass = context.getClassResolver().resolveMandatoryClass(className).     if (Message.class.isAssignableFrom(instanceClass)) {         try {             Method method = instanceClass.getMethod("getDefaultInstance").             return (Message) method.invoke(null).         } catch (final Exception ex) {             throw new CamelException("Can't set the defaultInstance of ProtobufferDataFormat with " + className + ", caused by " + ex).         }     } else {         throw new CamelException("Can't set the defaultInstance of ProtobufferDataFormat with " + className + ", as the class is not a subClass of com.google.protobuf.Message").     } }
false;protected;0;6;;@Override protected void doStart() throws Exception {     if (defaultInstance == null && instanceClassName != null) {         defaultInstance = loadDefaultInstance(instanceClassName, getCamelContext()).     } }
false;protected;0;4;;@Override protected void doStop() throws Exception { // noop }
