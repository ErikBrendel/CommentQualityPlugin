commented;modifiers;parameterAmount;loc;comment;code
false;public;0;3;;public Integer getPort() {     return port. }
false;public;1;4;;@Resource(name = "dynaPort") public void setPort(Integer port) {     this.port = port. }
false;public,static;0;4;;@BeforeClass public static void setUpJaas() throws Exception {     System.setProperty("java.security.auth.login.config", "src/test/resources/myjaas.config"). }
false;public,static;0;4;;@AfterClass public static void tearDownJaas() throws Exception {     System.clearProperty("java.security.auth.login.config"). }
false;public;0;30;;@Test public void testAdminAuth() throws Exception {     mockEndpoint.reset().     mockEndpoint.expectedBodiesReceived("Hello Public", "Hello Foo", "Hello Admin").     // public do not need authentication     String out = template.requestBody("netty4-http:http://localhost:" + port + "/foo/public/welcome", "Hello Public", String.class).     assertEquals("Bye /foo/public/welcome", out).     // username:password is scott:secret     String auth = "Basic c2NvdHQ6c2VjcmV0".     out = template.requestBodyAndHeader("netty4-http:http://localhost:" + port + "/foo", "Hello Foo", "Authorization", auth, String.class).     assertEquals("Bye /foo", out).     out = template.requestBodyAndHeader("netty4-http:http://localhost:" + port + "/foo/admin/users", "Hello Admin", "Authorization", auth, String.class).     assertEquals("Bye /foo/admin/users", out).     mockEndpoint.assertIsSatisfied().     try {         template.requestBody("netty4-http:http://localhost:" + port + "/foo", "Hello Foo", String.class).         fail("Should send back 401").     } catch (CamelExecutionException e) {         NettyHttpOperationFailedException cause = (NettyHttpOperationFailedException) e.getCause().         assertEquals(401, cause.getStatusCode()).     } }
false;public;0;20;;@Test public void testGuestAuth() throws Exception {     // username:password is guest:secret     String auth = "Basic Z3Vlc3Q6c2VjcmV0".     String out = template.requestBodyAndHeader("netty4-http:http://localhost:" + port + "/foo/guest/hello", "Hello Guest", "Authorization", auth, String.class).     assertEquals("Bye /foo/guest/hello", out).     // but we can access foo as that is any roles     out = template.requestBodyAndHeader("netty4-http:http://localhost:" + port + "/foo", "Hello Foo", "Authorization", auth, String.class).     assertEquals("Bye /foo", out).     // accessing admin is restricted for guest user     try {         template.requestBodyAndHeader("netty4-http:http://localhost:" + port + "/foo/admin/users", "Hello Admin", "Authorization", auth, String.class).         fail("Should send back 401").     } catch (CamelExecutionException e) {         NettyHttpOperationFailedException cause = (NettyHttpOperationFailedException) e.getCause().         assertEquals(401, cause.getStatusCode()).     } }
