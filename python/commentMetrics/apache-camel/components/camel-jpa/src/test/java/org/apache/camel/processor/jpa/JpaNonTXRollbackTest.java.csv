commented;modifiers;parameterAmount;loc;comment;code
false;public;0;23;;@Test public void testNonTXRollback() throws Exception {     // first create three records     template.sendBody("jpa://" + SendEmail.class.getName(), new SendEmail("foo@beer.org")).     template.sendBody("jpa://" + SendEmail.class.getName(), new SendEmail("bar@beer.org")).     template.sendBody("jpa://" + SendEmail.class.getName(), new SendEmail("kaboom@beer.org")).     // should only rollback the failed     getMockEndpoint("mock:start").expectedMinimumMessageCount(5).     // and only the 2 good messages goes here     getMockEndpoint("mock:result").expectedMessageCount(2).     // start route     context.getRouteController().startRoute("foo").     assertMockEndpointsSatisfied().     assertEquals(1, foo.intValue()).     assertEquals(1, bar.intValue()).     // kaboom fails and we retry it again     assertTrue("Should be >= 2, was: " + kaboom.intValue(), kaboom.intValue() >= 2). }
false;public;1;14;;@Override public void process(Exchange exchange) throws Exception {     SendEmail send = exchange.getIn().getBody(SendEmail.class).     if ("kaboom@beer.org".equals(send.getAddress())) {         kaboom.incrementAndGet().         throw new IllegalArgumentException("Forced").     }     if ("foo@beer.org".equals(send.getAddress())) {         foo.incrementAndGet().     } else if ("bar@beer.org".equals(send.getAddress())) {         bar.incrementAndGet().     } }
false;public;0;22;;@Override public void configure() throws Exception {     from("jpa://" + SendEmail.class.getName() + "?consumer.transacted=false&delay=100").routeId("foo").noAutoStartup().to("mock:start").process(new Processor() {          @Override         public void process(Exchange exchange) throws Exception {             SendEmail send = exchange.getIn().getBody(SendEmail.class).             if ("kaboom@beer.org".equals(send.getAddress())) {                 kaboom.incrementAndGet().                 throw new IllegalArgumentException("Forced").             }             if ("foo@beer.org".equals(send.getAddress())) {                 foo.incrementAndGet().             } else if ("bar@beer.org".equals(send.getAddress())) {                 bar.incrementAndGet().             }         }     }).to("mock:result"). }
false;protected;0;27;;@Override protected RouteBuilder createRouteBuilder() throws Exception {     return new RouteBuilder() {          @Override         public void configure() throws Exception {             from("jpa://" + SendEmail.class.getName() + "?consumer.transacted=false&delay=100").routeId("foo").noAutoStartup().to("mock:start").process(new Processor() {                  @Override                 public void process(Exchange exchange) throws Exception {                     SendEmail send = exchange.getIn().getBody(SendEmail.class).                     if ("kaboom@beer.org".equals(send.getAddress())) {                         kaboom.incrementAndGet().                         throw new IllegalArgumentException("Forced").                     }                     if ("foo@beer.org".equals(send.getAddress())) {                         foo.incrementAndGet().                     } else if ("bar@beer.org".equals(send.getAddress())) {                         bar.incrementAndGet().                     }                 }             }).to("mock:result").         }     }. }
false;protected;0;4;;@Override protected String routeXml() {     return "org/apache/camel/processor/jpa/springJpaRouteTest.xml". }
false;protected;0;4;;@Override protected String selectAllString() {     return SELECT_ALL_STRING. }
