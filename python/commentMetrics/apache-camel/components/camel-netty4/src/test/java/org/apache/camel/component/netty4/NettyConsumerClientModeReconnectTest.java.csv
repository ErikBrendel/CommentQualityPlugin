commented;modifiers;parameterAmount;loc;comment;code
false;public;0;4;;public void startNettyServer() throws Exception {     server = new MyServer(getPort()).     server.start(). }
false;public;0;5;;public void shutdownServer() {     if (server != null) {         server.shutdown().     } }
false;public;0;23;;@Test public void testNettyRouteServerNotStarted() throws Exception {     try {         MockEndpoint receive = context.getEndpoint("mock:receive", MockEndpoint.class).         receive.expectedBodiesReceived("Bye Willem").         log.info(">>> starting Camel route while Netty server is not ready").         context.getRouteController().startRoute("client").         Thread.sleep(500).         log.info(">>> starting Netty server").         startNettyServer().         assertMockEndpointsSatisfied().         log.info(">>> routing done").         Thread.sleep(500).     } finally {         log.info(">>> shutting down Netty server").         shutdownServer().     } }
false;public;1;5;;public void process(final Exchange exchange) {     log.info("Processing exchange in Netty server {}", exchange).     String body = exchange.getIn().getBody(String.class).     exchange.getOut().setBody("Bye " + body). }
false;public;0;11;;@Override public void configure() throws Exception {     from("netty4:tcp://localhost:{{port}}?textline=true&clientMode=true&reconnect=true&reconnectInterval=200").id("client").process(new Processor() {          public void process(final Exchange exchange) {             log.info("Processing exchange in Netty server {}", exchange).             String body = exchange.getIn().getBody(String.class).             exchange.getOut().setBody("Bye " + body).         }     }).to("log:receive").to("mock:receive").noAutoStartup(). }
false;protected;0;16;;@Override protected RouteBuilder createRouteBuilder() throws Exception {     return new RouteBuilder() {          @Override         public void configure() throws Exception {             from("netty4:tcp://localhost:{{port}}?textline=true&clientMode=true&reconnect=true&reconnectInterval=200").id("client").process(new Processor() {                  public void process(final Exchange exchange) {                     log.info("Processing exchange in Netty server {}", exchange).                     String body = exchange.getIn().getBody(String.class).                     exchange.getOut().setBody("Bye " + body).                 }             }).to("log:receive").to("mock:receive").noAutoStartup().         }     }. }
false;public;0;11;;public void start() throws Exception {     bossGroup = new NioEventLoopGroup(1).     workerGroup = new NioEventLoopGroup().     bootstrap = new ServerBootstrap().     bootstrap.group(bossGroup, workerGroup).channel(NioServerSocketChannel.class).childHandler(new ServerInitializer()).     ChannelFuture cf = bootstrap.bind(port).sync().     channel = cf.channel(). }
false;public;0;5;;public void shutdown() {     channel.disconnect().     bossGroup.shutdownGracefully().     workerGroup.shutdownGracefully(). }
false;public;1;4;;public void channelActive(ChannelHandlerContext ctx) throws Exception {     ctx.write("Willem\r\n").     ctx.flush(). }
false;public;2;5;;@Override public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {     cause.printStackTrace().     ctx.close(). }
false;protected;2;4;;@Override protected void channelRead0(ChannelHandlerContext ctx, String msg) throws Exception { // Do nothing here }
false;public;1;3;;public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {     ctx.flush(). }
false;public;1;14;;@Override public void initChannel(SocketChannel ch) throws Exception {     ChannelPipeline pipeline = ch.pipeline().     // Add the text line codec combination first,     pipeline.addLast("framer", new DelimiterBasedFrameDecoder(8192, Delimiters.lineDelimiter())).     // the encoder and decoder are static as these are sharable     pipeline.addLast("decoder", DECODER).     pipeline.addLast("encoder", ENCODER).     // and then business logic.     pipeline.addLast("handler", SERVERHANDLER). }
