commented;modifiers;parameterAmount;loc;comment;code
false;public;0;11;;@Test public void testMyCodec() throws Exception {     MockEndpoint mock = getMockEndpoint("mock:result").     mock.expectedMessageCount(1).     mock.expectedBodiesReceived("Bye World").     Object out = template.requestBody(String.format("mina2:tcp://localhost:%1$s?sync=true&codec=#myCodec", getPort()), "Hello World").     assertEquals("Bye World", out).     mock.assertIsSatisfied(). }
false;public;0;20;;@Test public void testProducerFailInDecodingResponse() throws Exception {     MockEndpoint mock = getMockEndpoint("mock:result").     mock.expectedMessageCount(1).     try {         template.requestBody(String.format("mina2:tcp://localhost:%1$s?sync=true&codec=#failingCodec", getPort()), "Hello World").         fail("Expecting that decode of result fails").     } catch (Exception e) {         assertTrue(e instanceof CamelExecutionException).         assertNotNull(e.getCause()).         Throwable rootCause = e.         while (rootCause.getCause() != null) {             rootCause = rootCause.getCause().         }         assertTrue(rootCause instanceof IllegalArgumentException).         assertTrue(rootCause.getMessage().contains("Something went wrong in decode")).     } }
false;public;0;4;;@Override public void configure() {     from(myUri).to("mock:result"). }
false;public;0;21;;@Test public void testTCPEncodeUTF8InputIsString() throws Exception {     final String myUri = String.format("mina2:tcp://localhost:%1$s?encoding=UTF-8&sync=false", getNextPort()).     context.addRoutes(new RouteBuilder() {          @Override         public void configure() {             from(myUri).to("mock:result").         }     }).     MockEndpoint endpoint = getMockEndpoint("mock:result").     // include a UTF-8 char in the text \u0E08 is a Thai elephant     String body = "Hello Thai Elephant \u0E08".     endpoint.expectedMessageCount(1).     endpoint.expectedBodiesReceived(body).     template.sendBody(myUri, body).     assertMockEndpointsSatisfied(). }
false;public;0;9;;@Test public void testBadConfiguration() throws Exception {     try {         template.sendBody(String.format("mina2:tcp://localhost:%1$s?sync=true&codec=#XXX", getPort()), "Hello World").         fail("Should have thrown a ResolveEndpointFailedException").     } catch (ResolveEndpointFailedException e) {     // ok     } }
false;protected;0;7;;@Override protected JndiRegistry createRegistry() throws Exception {     JndiRegistry jndi = super.createRegistry().     jndi.bind("myCodec", new MyCodec()).     jndi.bind("failingCodec", new MyCodec(true)).     return jndi. }
false;public;0;4;;@Override public void configure() throws Exception {     from(String.format("mina2:tcp://localhost:%1$s?sync=true&codec=#myCodec", getPort())).transform(constant("Bye World")).to("mock:result"). }
false;protected;0;10;;@Override protected RouteBuilder createRouteBuilder() throws Exception {     return new RouteBuilder() {          @Override         public void configure() throws Exception {             from(String.format("mina2:tcp://localhost:%1$s?sync=true&codec=#myCodec", getPort())).transform(constant("Bye World")).to("mock:result").         }     }. }
false;public;3;9;;@Override public void encode(IoSession ioSession, Object message, ProtocolEncoderOutput out) throws Exception {     IoBuffer bb = IoBuffer.allocate(32).setAutoExpand(true).     String s = (String) message.     bb.put(s.getBytes("US-ASCII")).     bb.flip().     out.write(bb). }
false;public;1;4;;@Override public void dispose(IoSession ioSession) throws Exception { // do nothing }
false;public;1;21;;@Override public ProtocolEncoder getEncoder(IoSession session) throws Exception {     return new ProtocolEncoder() {          @Override         public void encode(IoSession ioSession, Object message, ProtocolEncoderOutput out) throws Exception {             IoBuffer bb = IoBuffer.allocate(32).setAutoExpand(true).             String s = (String) message.             bb.put(s.getBytes("US-ASCII")).             bb.flip().             out.write(bb).         }          @Override         public void dispose(IoSession ioSession) throws Exception {         // do nothing         }     }. }
false;protected;3;15;;@Override protected boolean doDecode(IoSession session, IoBuffer in, ProtocolDecoderOutput out) throws Exception {     if (failing) {         throw new IllegalArgumentException("Something went wrong in decode").     }     if (in.remaining() > 0) {         byte[] buf = new byte[in.remaining()].         in.get(buf).         out.write(new String(buf, "US-ASCII")).         return true.     } else {         return false.     } }
false;public;1;21;;@Override public ProtocolDecoder getDecoder(IoSession session) throws Exception {     return new CumulativeProtocolDecoder() {          @Override         protected boolean doDecode(IoSession session, IoBuffer in, ProtocolDecoderOutput out) throws Exception {             if (failing) {                 throw new IllegalArgumentException("Something went wrong in decode").             }             if (in.remaining() > 0) {                 byte[] buf = new byte[in.remaining()].                 in.get(buf).                 out.write(new String(buf, "US-ASCII")).                 return true.             } else {                 return false.             }         }     }. }
