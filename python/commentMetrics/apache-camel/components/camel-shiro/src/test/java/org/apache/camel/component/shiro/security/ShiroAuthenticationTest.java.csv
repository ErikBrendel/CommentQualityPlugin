commented;modifiers;parameterAmount;loc;comment;code
false;public;0;14;;@Test public void testShiroAuthenticationFailure() throws Exception {     // Incorrect password     ShiroSecurityToken shiroSecurityToken = new ShiroSecurityToken("ringo", "stirr").     TestShiroSecurityTokenInjector shiroSecurityTokenInjector = new TestShiroSecurityTokenInjector(shiroSecurityToken, passPhrase).     successEndpoint.expectedMessageCount(0).     failureEndpoint.expectedMessageCount(1).     template.send("direct:secureEndpoint", shiroSecurityTokenInjector).     successEndpoint.assertIsSatisfied().     failureEndpoint.assertIsSatisfied(). }
false;public;0;13;;@Test public void testSuccessfulShiroAuthenticationWithNoAuthorization() throws Exception {     ShiroSecurityToken shiroSecurityToken = new ShiroSecurityToken("ringo", "starr").     TestShiroSecurityTokenInjector shiroSecurityTokenInjector = new TestShiroSecurityTokenInjector(shiroSecurityToken, passPhrase).     successEndpoint.expectedMessageCount(1).     failureEndpoint.expectedMessageCount(0).     template.send("direct:secureEndpoint", shiroSecurityTokenInjector).     successEndpoint.assertIsSatisfied().     failureEndpoint.assertIsSatisfied(). }
false;public;0;12;;@Test public void testSuccessfulTokenHeader() throws Exception {     ShiroSecurityToken shiroSecurityToken = new ShiroSecurityToken("ringo", "starr").     successEndpoint.expectedMessageCount(1).     failureEndpoint.expectedMessageCount(0).     template.sendBodyAndHeader("direct:secureEndpoint", "Beatle Mania", ShiroSecurityConstants.SHIRO_SECURITY_TOKEN, shiroSecurityToken).     successEndpoint.assertIsSatisfied().     failureEndpoint.assertIsSatisfied(). }
false;public;0;13;;@Test public void testSuccessfulUsernameHeader() throws Exception {     successEndpoint.expectedMessageCount(1).     failureEndpoint.expectedMessageCount(0).     Map<String, Object> headers = new HashMap<>().     headers.put(ShiroSecurityConstants.SHIRO_SECURITY_USERNAME, "ringo").     headers.put(ShiroSecurityConstants.SHIRO_SECURITY_PASSWORD, "starr").     template.sendBodyAndHeaders("direct:secureEndpoint", "Beatle Mania", headers).     successEndpoint.assertIsSatisfied().     failureEndpoint.assertIsSatisfied(). }
false;public;0;11;;@SuppressWarnings("unchecked") public void configure() {     onException(UnknownAccountException.class, IncorrectCredentialsException.class, LockedAccountException.class, AuthenticationException.class).to("mock:authenticationException").     from("direct:secureEndpoint").policy(securityPolicy).to("log:incoming payload").to("mock:success"). }
false;protected;0;17;;protected RouteBuilder createRouteBuilder() throws Exception {     final ShiroSecurityPolicy securityPolicy = new ShiroSecurityPolicy("src/test/resources/securityconfig.ini", passPhrase).     return new RouteBuilder() {          @SuppressWarnings("unchecked")         public void configure() {             onException(UnknownAccountException.class, IncorrectCredentialsException.class, LockedAccountException.class, AuthenticationException.class).to("mock:authenticationException").             from("direct:secureEndpoint").policy(securityPolicy).to("log:incoming payload").to("mock:success").         }     }. }
false;public;1;4;;public void process(Exchange exchange) throws Exception {     exchange.getIn().setHeader(ShiroSecurityConstants.SHIRO_SECURITY_TOKEN, encrypt()).     exchange.getIn().setBody("Beatle Mania"). }
