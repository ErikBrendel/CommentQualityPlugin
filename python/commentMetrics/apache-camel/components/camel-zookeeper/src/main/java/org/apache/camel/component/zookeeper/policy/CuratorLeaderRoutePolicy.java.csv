commented;modifiers;parameterAmount;loc;comment;code
false;public;1;18;;@Override public void onInit(Route route) {     ensureElectionIsCreated(route).     LOG.info("Route managed by {}. Setting route {} AutoStartup flag to false.", this.getClass(), route.getId()).     RouteDefinition definition = (RouteDefinition) route.getRouteContext().getRoute().     definition.setAutoStartup("false").     ensureElectionIsCreated(route).     if (election.isMaster()) {         if (shouldStopRoute) {             startManagedRoute(route).         }     } else {         if (shouldStopRoute) {             stopManagedRoute(route).         }     } }
false;private;1;13;;private void ensureElectionIsCreated(Route route) {     if (election == null) {         electionLock.lock().         try {             if (election == null) {                 // re-test                 election = new CuratorLeaderElection(route.getRouteContext().getCamelContext(), uri).                 election.addElectionWatcher(this).             }         } finally {             electionLock.unlock().         }     } }
false;private;1;13;;private void startManagedRoute(Route route) {     try {         lock.lock().         if (suspendedRoutes.contains(route)) {             startRoute(route).             suspendedRoutes.remove(route).         }     } catch (Exception e) {         handleException(e).     } finally {         lock.unlock().     } }
false;private;1;14;;private void stopManagedRoute(Route route) {     try {         lock.lock().         // check that we should still suspend once the lock is acquired         if (!suspendedRoutes.contains(route) && !shouldProcessExchanges.get()) {             stopRoute(route).             suspendedRoutes.add(route).         }     } catch (Exception e) {         handleException(e).     } finally {         lock.unlock().     } }
false;public;0;6;;@Override public void electionResultChanged() {     if (election.isMaster()) {         startAllStoppedRoutes().     } }
false;private;0;20;;private void startAllStoppedRoutes() {     try {         lock.lock().         if (!suspendedRoutes.isEmpty()) {             if (log.isDebugEnabled()) {                 log.debug("{} route(s) have been stopped previously by policy, restarting.", suspendedRoutes.size()).             }             for (Route suspended : suspendedRoutes) {                 log.debug("Starting route {}.", suspended.getId()).                 startRoute(suspended).             }             suspendedRoutes.clear().         }     } catch (Exception e) {         handleException(e).     } finally {         lock.unlock().     } }
false;protected;0;4;;@Override protected void doShutdown() throws Exception {     election.shutdownClients(). }
