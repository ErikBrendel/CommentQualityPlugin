commented;modifiers;parameterAmount;loc;comment;code
true;public,static;1;7;// stolen from org/apache/camel/processor/CamelInternalProcessor ;// stolen from org/apache/camel/processor/CamelInternalProcessor public static boolean isCamelStopping(CamelContext context) {     if (context instanceof StatefulService) {         StatefulService ss = (StatefulService) context.         return ss.isStopping() || ss.isStopped().     }     return false. }
false;public;0;7;;public void shutdownClients() {     try {         leaderSelector.close().     } finally {         client.close().     } }
false;public;0;3;;public boolean isMaster() {     return masterNode.get(). }
false;private;0;12;;private String createCandidateName() {     StringBuilder builder = new StringBuilder().     try {         /* UUID would be enough, also using hostname for human readability */         builder.append(InetAddress.getLocalHost().getCanonicalHostName()).     } catch (UnknownHostException ex) {         LOG.warn("Failed to get the local hostname.", ex).         builder.append("unknown-host").     }     builder.append("-").append(uuidGenerator.generateUuid()).     return builder.toString(). }
false;public;0;3;;public String getCandidateName() {     return candidateName. }
false;private;0;9;;private void notifyElectionWatchers() {     for (ElectionWatcher watcher : watchers) {         try {             watcher.electionResultChanged().         } catch (Exception e) {             LOG.warn("Election watcher " + watcher + " of type " + watcher.getClass() + " threw an exception.", e).         }     } }
false;public;1;3;;public boolean addElectionWatcher(ElectionWatcher e) {     return watchers.add(e). }
false;public;1;19;;@Override public void takeLeadership(CuratorFramework curatorFramework) throws Exception {     masterNode.set(true).     LOG.info("{} is now leader", getCandidateName()).     notifyElectionWatchers().     // this is supposed to never return as long as it wants to keep its own leader status     while (!isCamelStopping(camelContext)) {         try {             Thread.sleep(5000).         } catch (InterruptedException e) {             Thread.interrupted().             break.         }     }     masterNode.set(false).     LOG.info("{} has given up its own leadership", getCandidateName()).     notifyElectionWatchers(). }
