commented;modifiers;parameterAmount;loc;comment;code
false;public;1;28;;@Override public void writeTo(OutputStream outstream) throws IOException {     NoCloseOutputStream ncos = new NoCloseOutputStream(outstream).     // Write out mime part headers if this is not the main body of message.     if (!isMainBody()) {         try (CanonicalOutputStream canonicalOutstream = new CanonicalOutputStream(ncos, AS2Charset.US_ASCII)) {             HeaderIterator it = headerIterator().             while (it.hasNext()) {                 Header header = it.nextHeader().                 canonicalOutstream.writeln(header.toString()).             }             // ensure empty line between             canonicalOutstream.writeln().         // headers and body. RFC2046 -         // 5.1.1         }     }     // Write out signed data.     String transferEncoding = getContentTransferEncoding() == null ? null : getContentTransferEncoding().getValue().     try (OutputStream transferEncodedStream = EntityUtils.encode(ncos, transferEncoding)) {         transferEncodedStream.write(encryptedData).     } catch (Exception e) {         throw new IOException("Failed to write to output stream", e).     } }
false;public;1;3;;public MimeEntity getEncryptedEntity(PrivateKey privateKey) throws HttpException {     return EntityParser.parseEnvelopedEntity(encryptedData, privateKey). }
false;private;3;12;;private byte[] createEncryptedData(MimeEntity entity2Encrypt, CMSEnvelopedDataGenerator envelopedDataGenerator, OutputEncryptor encryptor) throws Exception {     try (ByteArrayOutputStream bos = new ByteArrayOutputStream()) {         entity2Encrypt.writeTo(bos).         bos.flush().         CMSTypedData contentData = new CMSProcessableByteArray(bos.toByteArray()).         CMSEnvelopedData envelopedData = envelopedDataGenerator.generate(contentData, encryptor).         return envelopedData.getEncoded().     } catch (Exception e) {         throw new Exception("", e).     } }
