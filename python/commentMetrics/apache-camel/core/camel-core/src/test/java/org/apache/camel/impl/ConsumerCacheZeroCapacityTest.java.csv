commented;modifiers;parameterAmount;loc;comment;code
false;public;0;30;;@Test public void testConsumerCacheZeroCapacity() throws Exception {     DefaultConsumerCache cache = new DefaultConsumerCache(this, context, -1).     cache.start().     assertEquals("Size should be 0", 0, cache.size()).     Endpoint endpoint = context.getEndpoint("file:target/data/foo?fileName=foo.txt&initialDelay=0&delay=10").     PollingConsumer consumer = cache.acquirePollingConsumer(endpoint).     assertNotNull(consumer).     assertEquals("Started", ((ServiceSupport) consumer).getStatus().name()).     // let it run a poll     consumer.receive(50).     boolean found = Thread.getAllStackTraces().keySet().stream().anyMatch(t -> t.getName().contains("target/data/foo")).     assertFalse("Should not find file consumer thread", found).     cache.releasePollingConsumer(endpoint, consumer).     // takes a little to stop     await().atMost(1, TimeUnit.SECONDS).untilAsserted(() -> assertEquals("Stopped", ((ServiceSupport) consumer).getStatus().name())).     // should not be a file consumer thread     found = Thread.getAllStackTraces().keySet().stream().anyMatch(t -> t.getName().contains("target/data/foo")).     assertFalse("Should not find file consumer thread", found).     cache.stop(). }
