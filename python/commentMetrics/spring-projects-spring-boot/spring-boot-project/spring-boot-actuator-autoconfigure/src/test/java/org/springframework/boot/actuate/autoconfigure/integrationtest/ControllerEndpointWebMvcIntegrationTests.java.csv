commented;modifiers;parameterAmount;loc;comment;code
false;public;0;5;;@After public void close() {     TestSecurityContextHolder.clearContext().     this.context.close(). }
false;public;0;8;;@Test public void endpointsAreSecureByDefault() throws Exception {     this.context = new AnnotationConfigWebApplicationContext().     this.context.register(SecureConfiguration.class, ExampleController.class).     MockMvc mockMvc = createSecureMockMvc().     mockMvc.perform(get("/actuator/example").accept(MediaType.APPLICATION_JSON)).andExpect(status().isUnauthorized()). }
false;public;0;13;;@Test public void endpointsCanBeAccessed() throws Exception {     TestSecurityContextHolder.getContext().setAuthentication(new TestingAuthenticationToken("user", "N/A", "ROLE_ACTUATOR")).     this.context = new AnnotationConfigWebApplicationContext().     this.context.register(SecureConfiguration.class, ExampleController.class).     TestPropertyValues.of("management.endpoints.web.base-path:/management", "management.endpoints.web.exposure.include=*").applyTo(this.context).     MockMvc mockMvc = createSecureMockMvc().     mockMvc.perform(get("/management/example")).andExpect(status().isOk()). }
false;private;0;3;;private MockMvc createSecureMockMvc() {     return doCreateMockMvc(springSecurity()). }
false;private;1;9;;private MockMvc doCreateMockMvc(MockMvcConfigurer... configurers) {     this.context.setServletContext(new MockServletContext()).     this.context.refresh().     DefaultMockMvcBuilder builder = MockMvcBuilders.webAppContextSetup(this.context).     for (MockMvcConfigurer configurer : configurers) {         builder.apply(configurer).     }     return builder.build(). }
false;public;0;4;;@GetMapping("/") public String example() {     return "Example". }
