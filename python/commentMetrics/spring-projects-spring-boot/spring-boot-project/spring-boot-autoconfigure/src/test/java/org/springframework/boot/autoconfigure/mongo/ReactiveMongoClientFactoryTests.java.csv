commented;modifiers;parameterAmount;loc;comment;code
false;public;0;9;;@Test public void portCanBeCustomized() {     MongoProperties properties = new MongoProperties().     properties.setPort(12345).     MongoClient client = createMongoClient(properties).     List<ServerAddress> allAddresses = extractServerAddresses(client).     assertThat(allAddresses).hasSize(1).     assertServerAddress(allAddresses.get(0), "localhost", 12345). }
false;public;0;9;;@Test public void hostCanBeCustomized() {     MongoProperties properties = new MongoProperties().     properties.setHost("mongo.example.com").     MongoClient client = createMongoClient(properties).     List<ServerAddress> allAddresses = extractServerAddresses(client).     assertThat(allAddresses).hasSize(1).     assertServerAddress(allAddresses.get(0), "mongo.example.com", 27017). }
false;public;0;8;;@Test public void credentialsCanBeCustomized() {     MongoProperties properties = new MongoProperties().     properties.setUsername("user").     properties.setPassword("secret".toCharArray()).     MongoClient client = createMongoClient(properties).     assertMongoCredential(extractMongoCredentials(client), "user", "secret", "test"). }
false;public;0;9;;@Test public void databaseCanBeCustomized() {     MongoProperties properties = new MongoProperties().     properties.setDatabase("foo").     properties.setUsername("user").     properties.setPassword("secret".toCharArray()).     MongoClient client = createMongoClient(properties).     assertMongoCredential(extractMongoCredentials(client), "user", "secret", "foo"). }
false;public;0;9;;@Test public void authenticationDatabaseCanBeCustomized() {     MongoProperties properties = new MongoProperties().     properties.setAuthenticationDatabase("foo").     properties.setUsername("user").     properties.setPassword("secret".toCharArray()).     MongoClient client = createMongoClient(properties).     assertMongoCredential(extractMongoCredentials(client), "user", "secret", "foo"). }
false;public;0;13;;@Test public void uriCanBeCustomized() {     MongoProperties properties = new MongoProperties().     properties.setUri("mongodb://user:secret@mongo1.example.com:12345," + "mongo2.example.com:23456/test").     MongoClient client = createMongoClient(properties).     List<ServerAddress> allAddresses = extractServerAddresses(client).     assertThat(allAddresses).hasSize(2).     assertServerAddress(allAddresses.get(0), "mongo1.example.com", 12345).     assertServerAddress(allAddresses.get(1), "mongo2.example.com", 23456).     MongoCredential credential = extractMongoCredentials(client).     assertMongoCredential(credential, "user", "secret", "test"). }
false;public;0;7;;@Test public void retryWritesIsPropagatedFromUri() {     MongoProperties properties = new MongoProperties().     properties.setUri("mongodb://localhost/test?retryWrites=true").     MongoClient client = createMongoClient(properties).     assertThat(getSettings(client).getRetryWrites()).isTrue(). }
false;public;0;10;;@Test public void uriCannotBeSetWithCredentials() {     MongoProperties properties = new MongoProperties().     properties.setUri("mongodb://127.0.0.1:1234/mydb").     properties.setUsername("user").     properties.setPassword("secret".toCharArray()).     assertThatIllegalStateException().isThrownBy(() -> createMongoClient(properties)).withMessageContaining("Invalid mongo configuration, " + "either uri or host/port/credentials must be specified"). }
false;public;0;10;;@Test public void uriCannotBeSetWithHostPort() {     MongoProperties properties = new MongoProperties().     properties.setUri("mongodb://127.0.0.1:1234/mydb").     properties.setHost("localhost").     properties.setPort(4567).     assertThatIllegalStateException().isThrownBy(() -> createMongoClient(properties)).withMessageContaining("Invalid mongo configuration, " + "either uri or host/port/credentials must be specified"). }
false;public;0;10;;@Test public void uriIsIgnoredInEmbeddedMode() {     MongoProperties properties = new MongoProperties().     properties.setUri("mongodb://mongo.example.com:1234/mydb").     this.environment.setProperty("local.mongo.port", "4000").     MongoClient client = createMongoClient(properties, this.environment).     List<ServerAddress> allAddresses = extractServerAddresses(client).     assertThat(allAddresses).hasSize(1).     assertServerAddress(allAddresses.get(0), "localhost", 4000). }
false;public;0;8;;@Test public void customizerIsInvoked() {     MongoProperties properties = new MongoProperties().     MongoClientSettingsBuilderCustomizer customizer = mock(MongoClientSettingsBuilderCustomizer.class).     createMongoClient(properties, this.environment, customizer).     verify(customizer).customize(any(MongoClientSettings.Builder.class)). }
false;public;0;9;;@Test public void customizerIsInvokedWhenHostIsSet() {     MongoProperties properties = new MongoProperties().     properties.setHost("localhost").     MongoClientSettingsBuilderCustomizer customizer = mock(MongoClientSettingsBuilderCustomizer.class).     createMongoClient(properties, this.environment, customizer).     verify(customizer).customize(any(MongoClientSettings.Builder.class)). }
false;public;0;9;;@Test public void customizerIsInvokedForEmbeddedMongo() {     MongoProperties properties = new MongoProperties().     this.environment.setProperty("local.mongo.port", "27017").     MongoClientSettingsBuilderCustomizer customizer = mock(MongoClientSettingsBuilderCustomizer.class).     createMongoClient(properties, this.environment, customizer).     verify(customizer).customize(any(MongoClientSettings.Builder.class)). }
false;private;1;3;;private MongoClient createMongoClient(MongoProperties properties) {     return createMongoClient(properties, this.environment). }
false;private;3;6;;private MongoClient createMongoClient(MongoProperties properties, Environment environment, MongoClientSettingsBuilderCustomizer... customizers) {     return new ReactiveMongoClientFactory(properties, environment, Arrays.asList(customizers)).createMongoClient(null). }
false;private;1;5;;private List<ServerAddress> extractServerAddresses(MongoClient client) {     MongoClientSettings settings = getSettings(client).     ClusterSettings clusterSettings = settings.getClusterSettings().     return clusterSettings.getHosts(). }
false;private;1;3;;private MongoCredential extractMongoCredentials(MongoClient client) {     return getSettings(client).getCredential(). }
false;private;1;5;;@SuppressWarnings("deprecation") private MongoClientSettings getSettings(MongoClient client) {     return (MongoClientSettings) ReflectionTestUtils.getField(client.getSettings(), "wrapped"). }
false;private;3;5;;private void assertServerAddress(ServerAddress serverAddress, String expectedHost, int expectedPort) {     assertThat(serverAddress.getHost()).isEqualTo(expectedHost).     assertThat(serverAddress.getPort()).isEqualTo(expectedPort). }
false;private;4;6;;private void assertMongoCredential(MongoCredential credentials, String expectedUsername, String expectedPassword, String expectedSource) {     assertThat(credentials.getUserName()).isEqualTo(expectedUsername).     assertThat(credentials.getPassword()).isEqualTo(expectedPassword.toCharArray()).     assertThat(credentials.getSource()).isEqualTo(expectedSource). }
