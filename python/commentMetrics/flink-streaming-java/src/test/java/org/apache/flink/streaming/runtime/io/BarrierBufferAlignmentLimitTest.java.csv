# id;timestamp;commentText;codeText;commentWords;codeWords
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1478636134;This tests that a single alignment that buffers too much data cancels;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1), _				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),_				_				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, IO_MANAGER, 1000)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(any(CheckpointMetaData.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,1000,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1487762095;This tests that a single alignment that buffers too much data cancels;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1), _				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),_				_				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, IO_MANAGER, 1000)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(any(CheckpointMetaData.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,1000,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1487871589;This tests that a single alignment that buffers too much data cancels;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1), _				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),_				_				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, IO_MANAGER, 1000)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,1000,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1493195810;This tests that a single alignment that buffers too much data cancels;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, IO_MANAGER, 1000)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,1000,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1495484544;This tests that a single alignment that buffers too much data cancels.;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 1000)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,1000,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1509118643;This tests that a single alignment that buffers too much data cancels.;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 1000)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,1000,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1515519059;This tests that a single alignment that buffers too much data cancels.;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 1000)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,1000,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1516285456;This tests that a single alignment that buffers too much data cancels.;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 1000)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,1000,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1516285878;This tests that a single alignment that buffers too much data cancels.;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 1000)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,1000,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1517489695;This tests that a single alignment that buffers too much data cancels.;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 1000)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,1000,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1519306056;This tests that a single alignment that buffers too much data cancels.;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, new BufferSpiller(ioManager, gate.getPageSize()), 1000)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,new,buffer,spiller,io,manager,gate,get,page,size,1000,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testBreakCheckpointAtAlignmentLimit() throws Exception;1538998760;This tests that a single alignment that buffers too much data cancels.;@Test_	public void testBreakCheckpointAtAlignmentLimit() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),_				 createBuffer(0, 42), createBuffer(2, 111),__				_				 createBarrier(7, 1),_				 createBuffer(1, 100), createBuffer(2, 200), createBuffer(1, 300), createBuffer(0, 50),_				 createBarrier(7, 0),_				 createBuffer(2, 100), createBuffer(0, 100), createBuffer(1, 200), createBuffer(0, 200),__				_				 createBuffer(0, 101),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(7, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, new BufferSpiller(ioManager, gate.getPageSize()), 1000)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		__		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())__		check(sequence[2], buffer.getNextNonBlocked())__		check(sequence[3], buffer.getNextNonBlocked())___		_		long startTs = System.nanoTime()__		check(sequence[6], buffer.getNextNonBlocked())__		check(sequence[8], buffer.getNextNonBlocked())__		check(sequence[10], buffer.getNextNonBlocked())___		_		check(sequence[5], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(7L), any(AlignmentLimitExceededException.class))___		_		check(sequence[7], buffer.getNextNonBlocked())__		check(sequence[11], buffer.getNextNonBlocked())__		check(sequence[12], buffer.getNextNonBlocked())__		check(sequence[13], buffer.getNextNonBlocked())__		check(sequence[14], buffer.getNextNonBlocked())___		_		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())__		check(sequence[17], buffer.getNextNonBlocked())___		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			any(CheckpointMetaData.class),_			any(CheckpointOptions.class),_			any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,that,a,single,alignment,that,buffers,too,much,data,cancels;test,public,void,test,break,checkpoint,at,alignment,limit,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,buffer,0,42,create,buffer,2,111,create,barrier,7,1,create,buffer,1,100,create,buffer,2,200,create,buffer,1,300,create,buffer,0,50,create,barrier,7,0,create,buffer,2,100,create,buffer,0,100,create,buffer,1,200,create,buffer,0,200,create,buffer,0,101,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,7,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,new,buffer,spiller,io,manager,gate,get,page,size,1000,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,check,sequence,2,buffer,get,next,non,blocked,check,sequence,3,buffer,get,next,non,blocked,long,start,ts,system,nano,time,check,sequence,6,buffer,get,next,non,blocked,check,sequence,8,buffer,get,next,non,blocked,check,sequence,10,buffer,get,next,non,blocked,check,sequence,5,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,7l,any,alignment,limit,exceeded,exception,class,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,12,buffer,get,next,non,blocked,check,sequence,13,buffer,get,next,non,blocked,check,sequence,14,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,any,checkpoint,meta,data,class,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1478636134;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2), _				 createBuffer(1, 100), createBuffer(2, 100), _				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, IO_MANAGER, 500)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(argThat(new CheckpointMatcher(4L)))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(argThat(new CheckpointMatcher(3L)))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,500,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1487762095;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2), _				 createBuffer(1, 100), createBuffer(2, 100), _				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, IO_MANAGER, 500)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(argThat(new CheckpointMatcher(4L)), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(argThat(new CheckpointMatcher(3L)), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,500,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1487871589;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2), _				 createBuffer(1, 100), createBuffer(2, 100), _				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, IO_MANAGER, 500)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,500,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1493195810;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, IO_MANAGER, 500)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,500,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1495484544;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes.;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 500)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,500,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1509118643;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes.;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 500)___		StatefulTask toNotify = mock(StatefulTask.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,500,stateful,task,to,notify,mock,stateful,task,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1515519059;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes.;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 500)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,500,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1516285456;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes.;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 500)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,500,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1516285878;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes.;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 500)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,500,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1517489695;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes.;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, ioManager, 500)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,io,manager,500,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1519306056;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes.;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, new BufferSpiller(ioManager, gate.getPageSize()), 500)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,new,buffer,spiller,io,manager,gate,get,page,size,500,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
BarrierBufferAlignmentLimitTest -> @Test 	public void testAlignmentLimitWithQueuedAlignments() throws Exception;1538998760;This tests the following case:_- an alignment starts_- barriers from a second checkpoint queue before the first completes_- together they are larger than the threshold_- after the first checkpoint (with second checkpoint data queued) aborts, the second completes.;@Test_	public void testAlignmentLimitWithQueuedAlignments() throws Exception {_		BufferOrEvent[] sequence = {_				_				 createBuffer(1, 100), createBuffer(2, 70),__				_				 createBarrier(3, 2),_				 createBuffer(1, 100), createBuffer(2, 100),_				 createBarrier(3, 0),_				 createBuffer(0, 100), createBuffer(1, 100),__				_				 createBarrier(4, 0),_				 createBuffer(0, 100), createBuffer(0, 120), createBuffer(1, 100),__				_				 createBuffer(2, 100),__				_				 createBarrier(3, 1),__				_				 createBarrier(4, 1),_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100),__				_				 createBarrier(4, 2),__				_				 createBuffer(0, 100), createBuffer(1, 100), createBuffer(2, 100)_		}___		_		MockInputGate gate = new MockInputGate(PAGE_SIZE, 3, Arrays.asList(sequence))__		BarrierBuffer buffer = new BarrierBuffer(gate, new BufferSpiller(ioManager, gate.getPageSize()), 500)___		AbstractInvokable toNotify = mock(AbstractInvokable.class)__		buffer.registerCheckpointEventHandler(toNotify)___		_		long startTs___		check(sequence[0], buffer.getNextNonBlocked())__		check(sequence[1], buffer.getNextNonBlocked())___		_		startTs = System.nanoTime()__		check(sequence[3], buffer.getNextNonBlocked())__		check(sequence[7], buffer.getNextNonBlocked())___		_		check(sequence[11], buffer.getNextNonBlocked())___		_		check(sequence[4], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).abortCheckpointOnBarrier(eq(3L), any(AlignmentLimitExceededException.class))___		_		check(sequence[6], buffer.getNextNonBlocked())__		startTs = System.nanoTime()__		check(sequence[12], buffer.getNextNonBlocked())___		_		check(sequence[17], buffer.getNextNonBlocked())___		_		check(sequence[9], buffer.getNextNonBlocked())__		validateAlignmentTime(startTs, buffer)__		verify(toNotify, times(1)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(4L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		check(sequence[10], buffer.getNextNonBlocked())__		check(sequence[15], buffer.getNextNonBlocked())__		check(sequence[16], buffer.getNextNonBlocked())___		_		check(sequence[19], buffer.getNextNonBlocked())__		check(sequence[20], buffer.getNextNonBlocked())__		check(sequence[21], buffer.getNextNonBlocked())___		_		verify(toNotify, times(0)).triggerCheckpointOnBarrier(_			argThat(new CheckpointMatcher(3L)), any(CheckpointOptions.class), any(CheckpointMetrics.class))___		assertNull(buffer.getNextNonBlocked())__		assertNull(buffer.getNextNonBlocked())___		buffer.cleanup()__		checkNoTempFilesRemain()__	};this,tests,the,following,case,an,alignment,starts,barriers,from,a,second,checkpoint,queue,before,the,first,completes,together,they,are,larger,than,the,threshold,after,the,first,checkpoint,with,second,checkpoint,data,queued,aborts,the,second,completes;test,public,void,test,alignment,limit,with,queued,alignments,throws,exception,buffer,or,event,sequence,create,buffer,1,100,create,buffer,2,70,create,barrier,3,2,create,buffer,1,100,create,buffer,2,100,create,barrier,3,0,create,buffer,0,100,create,buffer,1,100,create,barrier,4,0,create,buffer,0,100,create,buffer,0,120,create,buffer,1,100,create,buffer,2,100,create,barrier,3,1,create,barrier,4,1,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,create,barrier,4,2,create,buffer,0,100,create,buffer,1,100,create,buffer,2,100,mock,input,gate,gate,new,mock,input,gate,3,arrays,as,list,sequence,barrier,buffer,buffer,new,barrier,buffer,gate,new,buffer,spiller,io,manager,gate,get,page,size,500,abstract,invokable,to,notify,mock,abstract,invokable,class,buffer,register,checkpoint,event,handler,to,notify,long,start,ts,check,sequence,0,buffer,get,next,non,blocked,check,sequence,1,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,3,buffer,get,next,non,blocked,check,sequence,7,buffer,get,next,non,blocked,check,sequence,11,buffer,get,next,non,blocked,check,sequence,4,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,abort,checkpoint,on,barrier,eq,3l,any,alignment,limit,exceeded,exception,class,check,sequence,6,buffer,get,next,non,blocked,start,ts,system,nano,time,check,sequence,12,buffer,get,next,non,blocked,check,sequence,17,buffer,get,next,non,blocked,check,sequence,9,buffer,get,next,non,blocked,validate,alignment,time,start,ts,buffer,verify,to,notify,times,1,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,4l,any,checkpoint,options,class,any,checkpoint,metrics,class,check,sequence,10,buffer,get,next,non,blocked,check,sequence,15,buffer,get,next,non,blocked,check,sequence,16,buffer,get,next,non,blocked,check,sequence,19,buffer,get,next,non,blocked,check,sequence,20,buffer,get,next,non,blocked,check,sequence,21,buffer,get,next,non,blocked,verify,to,notify,times,0,trigger,checkpoint,on,barrier,arg,that,new,checkpoint,matcher,3l,any,checkpoint,options,class,any,checkpoint,metrics,class,assert,null,buffer,get,next,non,blocked,assert,null,buffer,get,next,non,blocked,buffer,cleanup,check,no,temp,files,remain
