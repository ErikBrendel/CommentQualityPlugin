commented;modifiers;parameterAmount;loc;comment;code
false;protected;0;6;;@Override protected void preSubmit() throws Exception {     verticesPath = createTempFile("vertices.txt", ConnectedComponentsData.getEnumeratingVertices(NUM_VERTICES)).     edgesPath = createTempFile("edges.txt", ConnectedComponentsData.getRandomOddEvenEdges(NUM_EDGES, NUM_VERTICES, SEED)).     resultPath = getTempFilePath("results"). }
false;protected;0;34;;@Override protected void testProgram() throws Exception {     // set up execution environment     ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment().     // read vertex and edge data     DataSet<Tuple1<Long>> vertices = env.readCsvFile(verticesPath).types(Long.class).     DataSet<Tuple2<Long, Long>> edges = env.readCsvFile(edgesPath).fieldDelimiter(" ").types(Long.class, Long.class).flatMap(new ConnectedComponents.UndirectEdge()).     // assign the initial components (equal to the vertex id)     DataSet<Tuple2<Long, Long>> verticesWithInitialId = vertices.map(new ConnectedComponentsITCase.DuplicateValue<Long>()).     // open a delta iteration     DeltaIteration<Tuple2<Long, Long>, Tuple2<Long, Long>> iteration = verticesWithInitialId.iterateDelta(verticesWithInitialId, 100, 0).     // apply the step logic: join with the edges, select the minimum neighbor, update if the component of the candidate is smaller     DataSet<Tuple2<Long, Long>> minNeighbor = iteration.getWorkset().join(edges).where(0).equalTo(0).with(new ConnectedComponents.NeighborWithComponentIDJoin()).groupBy(0).aggregate(Aggregations.MIN, 1).     DataSet<Tuple2<Long, Long>> updatedIds = iteration.getSolutionSet().join(minNeighbor).where(0).equalTo(0).with(new UpdateComponentIdMatchMirrored()).     // close the delta iteration (delta and new workset are identical)     DataSet<Tuple2<Long, Long>> result = iteration.closeWith(updatedIds, updatedIds).     result.writeAsCsv(resultPath, "\n", " ").     // execute program     env.execute("Connected Components Example"). }
false;protected;0;6;;@Override protected void postSubmit() throws Exception {     for (BufferedReader reader : getResultReader(resultPath)) {         ConnectedComponentsData.checkOddEvenResult(reader).     } }
false;public;3;11;;@Override public void join(Tuple2<Long, Long> current, Tuple2<Long, Long> candidate, Collector<Tuple2<Long, Long>> out) throws Exception {     if (candidate.f1 < current.f1) {         out.collect(candidate).     } }
