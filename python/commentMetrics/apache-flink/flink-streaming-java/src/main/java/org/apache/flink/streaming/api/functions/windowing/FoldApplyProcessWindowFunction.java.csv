commented;modifiers;parameterAmount;loc;comment;code
false;public;1;15;;@Override public void open(Configuration configuration) throws Exception {     FunctionUtils.openFunction(this.windowFunction, configuration).     if (serializedInitialValue == null) {         throw new RuntimeException("No initial value was serialized for the fold " + "window function. Probably the setOutputType method was not called.").     }     ByteArrayInputStream bais = new ByteArrayInputStream(serializedInitialValue).     DataInputViewStreamWrapper in = new DataInputViewStreamWrapper(bais).     initialValue = accSerializer.deserialize(in).     ctx = new InternalProcessApplyWindowContext<>(windowFunction). }
false;public;0;4;;@Override public void close() throws Exception {     FunctionUtils.closeFunction(this.windowFunction). }
false;public;1;6;;@Override public void setRuntimeContext(RuntimeContext t) {     super.setRuntimeContext(t).     FunctionUtils.setFunctionRuntimeContext(this.windowFunction, t). }
false;public;4;12;;@Override public void process(K key, Context context, Iterable<T> values, Collector<R> out) throws Exception {     ACC result = accSerializer.copy(initialValue).     for (T val : values) {         result = foldFunction.fold(result, val).     }     this.ctx.window = context.window().     this.ctx.context = context.     windowFunction.process(key, ctx, Collections.singletonList(result), out). }
false;public;1;6;;@Override public void clear(final Context context) throws Exception {     this.ctx.window = context.window().     this.ctx.context = context.     windowFunction.clear(ctx). }
false;public;2;16;;@Override public void setOutputType(TypeInformation<R> outTypeInfo, ExecutionConfig executionConfig) {     accSerializer = accTypeInformation.createSerializer(executionConfig).     ByteArrayOutputStream baos = new ByteArrayOutputStream().     DataOutputViewStreamWrapper out = new DataOutputViewStreamWrapper(baos).     try {         accSerializer.serialize(initialValue, out).     } catch (IOException ioe) {         throw new RuntimeException("Unable to serialize initial value of type " + initialValue.getClass().getSimpleName() + " of fold window function.", ioe).     }     serializedInitialValue = baos.toByteArray(). }
